#!/usr/bin/env -S uv run --script
# /// script
# requires-python = ">=3.11"
# dependencies = [
#     "pyttsx3",
# ]
# ///

import sys

def speak_text(text: str) -> bool:
    """
    Speak text using pyttsx3 TTS.

    Args:
        text: Text to speak

    Returns:
        True if speech was successful, False otherwise
    """
    try:
        import pyttsx3

        # Initialize TTS engine
        engine = pyttsx3.init()

        # Configure engine settings
        engine.setProperty('rate', 200)    # Speech rate (words per minute)
        engine.setProperty('volume', 0.6)  # Volume (0.0 to 1.0)

        # Speak the text
        engine.say(text)
        engine.runAndWait()

        return True

    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        return False

def main():
    if len(sys.argv) > 1:
        message = ' '.join(sys.argv[1:])
    else:
        message = None

    if not message:
        print("Error: No message provided", file=sys.stderr)
        sys.exit(1)

    success = speak_text(message)
    if not success:
        print(f"‚ùå Failed to speak: {message}", file=sys.stderr)
        sys.exit(1)

if __name__ == '__main__':
    main()
